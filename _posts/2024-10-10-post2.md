---1
date: 20
title: PRACTICA 024-10-11 00:00:00 -05:00
categories: [Made]
tags: [Made, GitHub]  # TAG names should always be lowercase
---

## Reconnaissance

En esta sección, describiremos la etapa de reconocimiento en un pentest o análisis de seguridad.  El reconocimiento es crucial para recopilar información sobre el objetivo antes de realizar cualquier otra acción.  Un buen reconocimiento permite identificar vulnerabilidades y planificar el ataque de manera efectiva.

### Preguntas sobre Nmap y TCP Handshake

1. ¿Por qué debemos ejecutar nmap con privilegios de root?

2. ¿Qué significan los flags `-sS`, `-sT`, `-sV`, `-O` en el escaneo de nmap?

3. ¿Existe algún flag que permite hacer un escaneo involucrando todos los flags mencionados anteriormente?  (No, no hay un solo flag que combine todos esos.  Se deben usar individualmente.)

4. Explicar el proceso de un handshake TCP.

5. Según la pregunta anterior, ¿qué significa el flag `-sS`?

6. ¿Qué hace el flag `--script`?

### Respuestas

1. Nmap necesita privilegios de root para realizar ciertas operaciones, como enviar paquetes raw y acceder a puertos privilegiados.  Sin privilegios de root, el escaneo será limitado y no podrá obtener toda la información.

2. * `-sS`: SYN scan (stealth scan).  Envía un paquete SYN y analiza la respuesta para determinar el estado del puerto.
   * `-sT`: TCP connect scan.  Realiza una conexión TCP completa.  Más detectable que el SYN scan.
   * `-sV`: Version detection.  Intenta determinar la versión del servicio que se ejecuta en el puerto.
   * `-O`: OS detection.  Intenta determinar el sistema operativo del objetivo.

3. No existe un único flag que combine todas las opciones mencionadas.  Debes usar cada flag individualmente en el comando nmap.

4. El handshake TCP es un proceso de tres pasos para establecer una conexión:
    * **SYN:** El cliente envía un paquete SYN (synchronize) al servidor.
    * **SYN-ACK:** El servidor responde con un paquete SYN-ACK (synchronize-acknowledge).
    * **ACK:** El cliente envía un paquete ACK (acknowledge) para confirmar la conexión.

5. El flag `-sS` realiza un SYN scan, que aprovecha el proceso de handshake TCP.  Solo envía el paquete SYN inicial y analiza la respuesta, sin completar la conexión. Esto lo hace más sigiloso.

6. El flag `--script` permite ejecutar scripts NSE (Nmap Scripting Engine).  Estos scripts amplían las funcionalidades de nmap, permitiendo realizar tareas como detección de vulnerabilidades, detección de versiones de software, etc.

## Weaponization: Del Reconocimiento a la Explotación

La fase de "Weaponization" en un ataque cibernético se refiere a la creación de una herramienta o payload que explota una vulnerabilidad previamente identificada.  En este contexto, analizaremos dos scripts de Metasploit que, si bien son herramientas legítimas para pruebas de penetración, pueden ser weaponizadas para fines maliciosos.  Es crucial entender su funcionamiento para fortalecer las defensas.

## Enumeración de Usuarios SSH (auxiliary/scanner/ssh/ssh_enumusers)

Este script se utiliza para enumerar usuarios en un servidor SSH. Este paso es crucial en la fase de reconocimiento, proporcionando información valiosa para etapas posteriores del ataque.

**¿En qué lenguaje de programación está hecho?**

El script `ssh_enumusers` está escrito en **Ruby**.

**Código y explicación:**

(Pega aquí el código del script `auxiliary/scanner/ssh/ssh_enumusers`.  Recuerda que necesito que proporciones el código).

```ruby
\# (Pega aquí el código del script ssh_enumusers)
\# (Pega aquí el código del script ssh_login)

Recuerda reemplazar los comentarios  `# (Pega aquí el código del script ...)` con el código real.  Este blog post ahora incluye el concepto de "weaponization" y cómo se relaciona con los scripts de Metasploit.

## Delivery/Exploitation: La Fase Crítica de un Ataque

Las etapas de Delivery y Exploitation son el núcleo de un ataque cibernético.  Representan el momento en que la amenaza se materializa, pasando de la planificación a la ejecución.  **Delivery** se centra en cómo se entrega el payload malicioso al objetivo, mientras que **Exploitation** se refiere a la ejecución del payload para aprovechar una vulnerabilidad y obtener acceso no autorizado.

### Delivery: El Arte del Engaño

El éxito de un ataque depende en gran medida de la efectividad de la entrega del payload.  Los atacantes emplean diversas técnicas, a menudo combinadas, para maximizar sus posibilidades de éxito.  Algunos métodos comunes incluyen:

* **Phishing:**  Engañar al usuario para que abra un archivo malicioso o haga clic en un enlace que lo descargue.  Suele utilizar correos electrónicos, mensajes instantáneos o sitios web falsos.
* **Ingeniería Social:** Manipular psicológicamente a las víctimas para que realicen acciones que comprometan la seguridad, como revelar contraseñas o descargar malware.
* **Watering Hole Attacks:** Comprometer sitios web que el objetivo visita con frecuencia, infectándolos con malware que se descarga automáticamente al acceder.
* **Explotación de Vulnerabilidades de Software:** Aprovechar vulnerabilidades en software, como navegadores web o plugins, para ejecutar código malicioso sin interacción del usuario (drive-by downloads).
* **Malvertising:** Inyectar anuncios maliciosos en redes publicitarias legítimas, redirigiendo a los usuarios a sitios web maliciosos o descargando malware.

### Exploitation: Aprovechando las Debilidades

Una vez entregado el payload, la fase de Exploitation se centra en aprovechar una o varias vulnerabilidades en el sistema objetivo.  Esto puede implicar:

* **Ejecución de Código Remoto:**  Tomar el control del sistema objetivo ejecutando código arbitrario.
* **Elevación de Privilegios:** Obtener acceso a recursos restringidos, a menudo después de la ejecución de código remoto, para obtener control total del sistema.
* **Denegación de Servicio (DoS):**  Interrumpir el funcionamiento normal de un sistema o servicio, haciéndolo inaccesible a los usuarios legítimos.
* **Exfiltración de Datos:**  Robar información confidencial del sistema objetivo, como datos financieros, propiedad intelectual o información personal.

### Mitigación

Protegerse contra estas etapas cruciales de un ataque requiere una estrategia de defensa multicapa:

* **Firewall:** Bloquear el tráfico malicioso.
* **Sistemas de Detección de Intrusos (IDS) y Prevención de Intrusos (IPS):**  Identificar y bloquear actividades sospechosas.
* **Software Antivirus y Antimalware:** Detectar y eliminar malware.
* **Análisis de Vulnerabilidades:** Identificar y corregir vulnerabilidades en el software y los sistemas.
* **Formación en Seguridad:** Educar a los usuarios sobre las tácticas de phishing y la ingeniería social.
* **Actualizaciones de Software:** Aplicar parches de seguridad regularmente.

Comprender las etapas de Delivery y Exploitation es fundamental para construir una defensa sólida y protegerse contra las amenazas cibernéticas.  La combinación de tecnología y formación es esencial para mitigar los riesgos y mantener la seguridad.
